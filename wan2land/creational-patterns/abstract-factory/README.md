# 추상팩토리 (Abstract Factory)

추상팩토리는 기존의 팩토리를 확장할 때 사용합니다. 동작 구조는 똑같고, 구현체가 여러개인 경우 사용합니다. 객체지향 프로그래밍에서는 의존성을 주입해서 사용하는 경우가 많습니다. "추상"이라는 용어 때문에 추상클래스를 사용해야 할 것 같지만 실제로 인터페이스를 포함한 개념입니다.

자동차를 만든다고 가정합시다. 바퀴를 만드는 공장과 엔진을 만드는 공장이 있다면 기본 팩토리 패턴을 사용하면 다음과 같이 구현합니다.

```text
┌─────────────────┐                   
│     Client      │                   
└─────────────────┘                   
         │                            
         ▼                            
┌─────────────────┐                   
│   CarFactory    │                   
├─────────────────┤      ┌───────────┐
│                 │ ────▶│  Engine   │
│+ createEngine() │      └───────────┘
│+ createWheels() │      ┌───────────┐
│                 │ ────▶│   Wheel   │
└─────────────────┘      └───────────┘
```

생산되는 자동차가 여러종류가 된다면 일반팩토리를 추상화할 필요성이 생깁니다.
버스와 트럭을 만드는 공장을 만든다고 가정합시다. 버스와 트럭 모두 엔진과 창문이 필요합니다.

버스공장(`BusFactory`)은 버스엔진(`BusEngine`), 버스바퀴(`BusWheel[]`)를 생산합니다. 그리고 트럭공장(`TruckFactory`)은
트럭엔진(`TruckEngine`), 트럭바퀴(`TruckWheel[]`)를 생산합니다. 그리고 이 공장을 사용하는 객체는 추상화된
자동차공장(`CarFactory`)만을 바라보고 있으면 됩니다. 구조는 다음과 같습니다.

```text
       ┌──────────────────┐       ┌──────────────────┐                              
       │      Client      │       │       Car        │                              
       ├──────────────────┤       ├──────────────────┤                              
       │+ createCar(): Car│──────▶│+ wheels: Wheel[] │                              
       └────────────┬─────┘       │+ engine: Engine  │                              
                    │             └──────────────────┘                              
                    ▼                                                               
       ┌─────────────────────────┐                                                  
       │      <<interface>>      │                                                  
       │       CarFactory        │────────────────────────┬───────────────┐         
       ├─────────────────────────┤                        ▼               │         
       │+ createEngine(): Engine │                  ┌───────────┐         │         
       │+ createWheels(): Wheel[]│                  │  Engine   │         │         
       └─────────────────────────┘                  └───────────┘         │         
                    △                                    △                │         
                    │                                    │                │         
        ┌ ─ ─ ─ ─ ─ ┘─ ─ ┐                          ┌ ─ ─ ─ ─ ─ ┐         │         
                                                                          │         
        │                │                          │           │         │         
┌──────────────┐ ┌───────────────┐             ┌─────────┐┌───────────┐   │         
│ TruckFactory │ │  BusFactory   │──┬─────────▶│BusEngine││TruckEngine│◀──┼────────┐
└──────────────┘ └───────────────┘  │          └─────────┘└───────────┘   │        │
        │                           │               ┌───────────┐         │        │
        │                           │               │   Wheel   │◀────────┘        │
        │                           │               └───────────┘                  │
        │                           │                     △                        │
        │                           │                     │                        │
        │                           │               ┌ ─ ─ ┘─ ─ ┐                   │
        │                           │                                              │
        │                           │               │          │                   │
        │                           │          ┌────────┐┌──────────┐              │
        │                           └─────────▶│BusWheel││TruckWheel│◀─────────────┤
        │                                      └────────┘└──────────┘              │
        └──────────────────────────────────────────────────────────────────────────┘
```

[소스보기](./sample.ts)

## Maze Sample

책에서 다룬 미로(Maze) 코드 샘플입니다.

[소스보기(Typescript)](./maze.ts)

## 실생활의 사용 예시

- Connector와 Connection (Connector가 Factory, Connection이 생성된 결과)
