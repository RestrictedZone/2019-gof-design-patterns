# 빌더 (Builder)

빌더 패턴은 3단계 - 클라이언트(Client), 디렉터(Director), 빌더(Builder) - 로 구성이 되어있습니다. 

책에는 구조가 다음과 같이 나와있습니다.

```text
┌─────────────┐      ┌─────────────┐                  
│  Director   │◇────▶│   Builder   │                  
├─────────────┤      ├─────────────┤                  
│+ Construct()│      │+ BuildPart()│                  
└─────────────┘      └─────────────┘                  
                            △                         
                            │                         
                    ┌───────────────┐      ┌─────────┐
                    │ConcreteBuilder│─ ─ ─▶│ Product │
                    ├───────────────┤      └─────────┘
                    │+ BuildPart()  │                 
                    │+ GetResult()  │                 
                    └───────────────┘                 
```

이 그림에는 클라이언트가 생략되어 있어서 설명 볼 때 난해합니다.

```text
┌────────┐    ┌─────────────┐      ┌─────────────┐                  
│ Client │───▶│  Director   │◇────▶│   Builder   │                  
└────────┘    ├─────────────┤      ├─────────────┤                  
              │+ Construct()│      │+ BuildPart()│                  
              └─────────────┘      └─────────────┘                  
                                          △                         
                                          │                         
                                  ┌───────────────┐      ┌─────────┐
                                  │ConcreteBuilder│─ ─ ─▶│ Product │
                                  ├───────────────┤      └─────────┘
                                  │+ BuildPart()  │                 
                                  │+ GetResult()  │                 
                                  └───────────────┘                 
```

빌더패턴에서 디렉터는 빌더의 인터페이스만을 바라보고 있습니다. 즉, `GetResult()`메서드는 호출할 수 없습니다.
디렉터는 빌더를 어떻게 생성하는지에 대해서만 알고 있습니다. 그리고 전체 객체를 만드는 행위(`GetResult()`)는
클라이언트에서 이루어집니다.

빌더를 추상화하면서, 클라이언트는 프로덕트(Product)가 어떻게 생성되는지 알 수 없고, 생성자체만 담당할 수 있습니다.
그리고 디렉터는 빌더 생성방식만을 알 수 있습니다. 그리고 마지막으로 빌더는 프로덕트를 조립하는 것만 집중할 수 있습니다.
이 과정을 통해 자연스럽게 클라이언트, 디렉터, 빌더 각자 맡은 일만 하게 됩니다. (관심사의 분리, SOC라고 합니다.)



## 실생활의 사용 예시

- Repository -> QueryBuilder 로 구성된 ORM
  - MVC 패턴을 사용한다고 가정하면, Controller에서는 Repository(Director)를 통해 데이터베이스 내용을 가져옵니다.
  - Repository는 QueryBuilder(Builder)를 통해 필요한 쿼리를 조합합니다.
  - QueryBuilder는 각 SQL에 맞는 방식(cf. MysqlQueryBuilder, SqliteQueryBuilder)으로 쿼리를 생성합니다.
